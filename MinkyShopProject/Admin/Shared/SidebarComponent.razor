@using System.IdentityModel.Tokens.Jwt;
<aside class="sidenav bg-white navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-4 " id="sidenav-main">
    <div class="sidenav-header">
        <NavLink class="navbar-brand m-0" href="/" target="_blank">
            <img src="./assets/img/logo.png" class="navbar-brand-img h-100" alt="main_logo">
            <span class="ms-1 font-weight-bold">Minky Shop</span>
        </NavLink>
    </div>
    <hr class="horizontal dark mt-0">
    <div class="w-auto " id="sidenav-collapse-main">
        <ul class="navbar-nav">
            <li class="nav-item">
                <NavLink class="nav-link" href="/admin">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <i class="ni ni-tv-2 text-primary text-sm opacity-10"></i>
                    </div>
                    <span class="nav-link-text ms-1">Trang Chủ</span>
                </NavLink>
                <NavLink class="nav-link" href="/sale">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <i class="ni ni-shop text-danger text-sm opacity-10"></i>
                    </div>
                    <span class="nav-link-text ms-1">Bán Hàng</span>
                </NavLink>
                <NavLink class="nav-link" href="/admin/invoice">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <i class="ni ni-archive-2 text-info text-sm opacity-10"></i>
                    </div>
                    <span class="nav-link-text ms-1">Hóa Đơn</span>
                </NavLink>
            </li>
            <li class="nav-item">
                <a data-bs-toggle="collapse" href="#applicationsExamples1515" class="nav-link" aria-controls="applicationsExamples" role="button" aria-expanded="true">
                    <div class="icon icon-shape icon-sm text-center d-flex align-items-center justify-content-center">
                        <i class="ni ni-ui-04 text-warning text-sm opacity-10"></i>
                    </div>
                    <span class="nav-link-text ms-1">Giao Ca</span>
                </a>
                <div class="collapse show" id="applicationsExamples1515" style="">
                    <ul class="nav ms-4">
                        <li class="nav-item">
                            <NavLink class="nav-link" href="/admin/ketca">
                                <span class="sidenav-mini-icon"> K </span>
                                <span class="sidenav-normal">Báo Cáo Kết Ca</span>
                            </NavLink>
                        </li>
                        <li class="nav-item">
                            <NavLink class="nav-link" href="/admin/lichsugiaoca/1">
                                <span class="sidenav-mini-icon"> W </span>
                                <span class="sidenav-normal">Quản Lí Ca</span>
                            </NavLink>
                        </li>
                    </ul>
                </div>
            </li>
            <li class="nav-item">
                <a data-bs-toggle="collapse" href="#applicationsExamples" class="nav-link" aria-controls="applicationsExamples" role="button" aria-expanded="true">
                    <div class="icon icon-shape icon-sm text-center d-flex align-items-center justify-content-center">
                        <i class="ni ni-ui-04 text-warning text-sm opacity-10"></i>
                    </div>
                    <span class="nav-link-text ms-1">Sản Phẩm</span>
                </a>
                <div class="collapse show" id="applicationsExamples" style="">
                    <ul class="nav ms-4">
                        <li class="nav-item ">
                            <NavLink class="nav-link " href="/admin/property">
                                <span class="sidenav-mini-icon"> K </span>
                                <span class="sidenav-normal"> Thuộc Tính </span>
                            </NavLink>
                        </li>
                        <li class="nav-item ">
                            <NavLink class="nav-link " href="/admin/group">
                                <span class="sidenav-mini-icon"> W </span>
                                <span class="sidenav-normal">Nhóm Sản Phẩm </span>
                            </NavLink>
                        </li>
                        <li class="nav-item ">
                            <NavLink class="nav-link " href="/admin/product">
                                <span class="sidenav-mini-icon"> K </span>
                                <span class="sidenav-normal"> Danh Sách Sản Phẩm</span>
                            </NavLink>
                        </li>
                    </ul>
                </div>
            </li>
            @if (Role == "0")
            {
                <li class="nav-item">
                    <NavLink class="nav-link" href="/admin/employee/1">
                        <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                            <i class="ni ni-single-02 text-dark text-sm opacity-10"></i>
                        </div>
                        <span class="nav-link-text ms-1">Nhân Viên</span>
                    </NavLink>
                </li>
            }
            <li class="nav-item">
                <NavLink class="nav-link" href="/admin/khachhang">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <i class="ni ni-glasses-2 text-success text-sm opacity-10"></i>
                    </div>
                    <span class="nav-link-text ms-1">Quản lí khách hàng</span>
                </NavLink>
            </li>
            @if (Role == "0")
            {
                <li class="nav-item">
                    <NavLink class="nav-link" href="/admin/voucher">
                        <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                            <i class="ni ni-bell-55 text-success text-sm opacity-10"></i>
                        </div>
                        <span class="nav-link-text ms-1">Quản lí Voucher</span>
                    </NavLink>
                </li>
            }
            <li class="nav-item">
                <NavLink class="nav-link" style="cursor:pointer" @onclick="DangXuat">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <i class="ni ni-bold-right text-danger text-sm opacity-10"></i>
                    </div>
                    <span class="nav-link-text ms-1">Đăng Xuất</span>
                </NavLink>
            </li>
        </ul>
    </div>
</aside>


@code {
    [Inject]
    public NavigationManager Navigation { get; set; } = null!;

    [Inject]
    public ILocalStorageService local { get; set; } = null!;

    public string Role = null!;

    protected async override Task OnInitializedAsync()
    {
        var jwt = new JwtSecurityTokenHandler().ReadJwtToken(await local.GetItemAsStringAsync("Token"));
        Role = jwt.Claims.FirstOrDefault(c => c.Type.Equals("VaiTro"))?.Value;
    }

    private async Task DangXuat()
    {
        await local.ClearAsync();
        Navigation.NavigateTo("/login");
    }
}